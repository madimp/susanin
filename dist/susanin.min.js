!function(t){function e(t){return{"./querystring":function(){var t={},e=Object.prototype.hasOwnProperty,r=Object.prototype.toString,n=function(t){return"[object Array]"===r.call(t)},a={decode:function(t){var e;try{e=decodeURIComponent(t.replace(/\+/g,"%20"))}catch(r){e=t}return e},parse:function(t,r,o){var i,s,u,p,f,l,h,c={};if("string"!=typeof t||""===t)return c;for(r||(r="&"),o||(o="="),i=t.split(r),p=0,f=i.length;f>p;++p)l=a.decode(i[p]),h=l.indexOf(o),h>=0?(u=l.substr(0,h),s=l.substr(h+1)):(u=l,s=""),e.call(c,u)?n(c[u])?c[u].push(s):c[u]=[c[u],s]:c[u]=s;return c},stringify:function(t,r,n){var a,o,i,s,u,p,f="";if(!t)return f;r||(r="&"),n||(n="=");for(p in t)if(e.call(t,p))for(i=[].concat(t[p]),s=0,u=i.length;u>s;++s)o=typeof i[s],a="object"===o||"undefined"===o?"":encodeURIComponent(i[s]),f+=r+encodeURIComponent(p)+n+a;return f.substr(r.length)}};return t.exports=a,t.exports},"./route":function(){function t(e){if(!(this instanceof t))return new t(e);if("string"==typeof e&&(e={pattern:e}),i(e)&&(e={patterns:e}),i(e.patterns)||(e.patterns=[]),e.pattern&&(e.patterns.push(e.pattern),delete e.pattern),!e||"object"!=typeof e)throw new Error("You must specify options");this._options=e,this._conditions=e.conditions&&"object"==typeof e.conditions?e.conditions:{},e.isTrailingSlashOptional!==!1&&(this._conditions[g]=y),this._conditions[b]=".*",this._subPatterns=[];for(var r=0,n=e.patterns.length;n>r;r++){var a=e.patterns[r],o={};if("string"!=typeof a)throw new Error("You must specify the pattern of the route");e.isTrailingSlashOptional!==!1&&(a+=h+f+g+l+c),a+=h+"?"+f+b+l+c,o._pattern=a,o._paramsMap=[],o._mainParamsMap={},o._requiredParams=[],o._optionalParams=[],o._parts=this._parsePattern(o,a),this._buildParseRegExp(o),this._buildBuildFn(o),this._subPatterns.push(o)}}var r={},n=Object.prototype.hasOwnProperty,a=function(t,e){return n.call(t,e)},o=Object.prototype.toString,i=function(t){return"[object Array]"===o.call(t)},s=e("./querystring"),u=function(){var t=["/",".","*","+","?","|","(",")","[","]","{","}","\\"],e=new RegExp("(\\"+t.join("|\\")+")","g");return function(t){return t.replace(e,"\\$1")}}(),p=String(Math.random()).substr(2,5),f="<",l=">",h="(",c=")",_="[a-zA-Z_][\\w\\-]*",d="[\\w\\-\\.~]+",m=new RegExp("("+u(f)+_+u(l)+"|"+"[^"+u(f)+u(l)+"]+"+"|"+u(f)+"|"+u(l)+")","g"),g="ts_"+p,P="/",y=u("/"),b="qs_"+p,v=1,x=2;return t.prototype._parsePattern=function(t,e,r){for(var n,a,o,i,s=[],u="",p=0,f=0,l=!1,_=e.length;_>p;)if(n=e.charAt(p++),n===h)l?(++f,u+=n):(this._parseParams(t,u,s,r),u="",f=0,l=!0);else if(n===c)if(l)if(0===f){for(u={what:"optional",dependOnParams:[],parts:this._parsePattern(t,u,!0)},s.push(u),a=0,o=u.parts.length;o>a;++a)i=u.parts[a]&&u.parts[a].what,"param"===i?u.dependOnParams.push(u.parts[a].name):"optional"===i&&u.dependOnParams.push.apply(u.dependOnParams,u.parts[a].dependOnParams);u="",l=!1}else--f,u+=n;else u+=n;else u+=n;return this._parseParams(t,u,s,r),s},t.prototype._parseParams=function(t,e,r,n){var a,o,i,s,u=e.match(m);if(u)for(a=0,o=u.length;o>a;++a)i=u[a],i.charAt(0)===f&&i.charAt(i.length-1)===l?(s=i.substr(1,i.length-2),t._paramsMap.push(s),t._mainParamsMap[s]=!0,n?t._optionalParams.push(s):t._requiredParams.push(s),r.push({what:"param",name:s})):r.push(i)},t.prototype._buildParseRegExp=function(t){t._parseRegExpSource="^"+this._buildParseRegExpParts(t._parts)+"$",t._parseRegExp=new RegExp(t._parseRegExpSource)},t.prototype._buildParseRegExpParts=function(t){var e,r,n,a="";for(e=0,r=t.length;r>e;++e)n=t[e],a+="string"==typeof n?u(n):"param"===n.what?"("+(this._getParamValueRegExpSource(n.name)||d)+")":"(?:"+this._buildParseRegExpParts(n.parts)+")?";return a},t.prototype._getParamValueRegExpSource=function(t){var e,r,n=this._conditionRegExpSources||(this._conditionRegExpSources={}),o=this._conditions;return a(n,t)||(a(o,t)?(r=o[t],e=i(r)?"(?:"+r.join("|")+")":r+""):e=null,n[t]=e),n[t]},t.prototype._getParamValueRegExp=function(t){var e,r=this._conditionRegExps||(this._conditionRegExps={});return a(r,t)||(e=this._getParamValueRegExpSource(t),r[t]=e?new RegExp("^"+e+"$"):null),r[t]},t.prototype._checkParamValue=function(t,e){var r=this._getParamValueRegExp(t);return r?r.test(e):!0},t.prototype._buildBuildFn=function(t){t._buildFnSource="var h=({}).hasOwnProperty;return "+this._buildBuildFnParts(t)+";",t._buildFn=new Function("p",t._buildFnSource)},t.prototype._buildBuildFnParts=function(t,e){var r,n,o,i,s,p,f='""',l=this._options.defaults;for(e||(e=t._parts),r=0,n=e.length;n>r;++r)if(s=e[r],"string"==typeof s)f+='+"'+u(s)+'"';else if("param"===s.what)t._mainParamsMap[s.name]=!0,f+='+(h.call(p,"'+u(s.name)+'")?'+'p["'+u(s.name)+'"]:'+(l&&a(l,s.name)?'"'+u(l[s.name])+'"':'""')+")";else{for(f+="+((false",o=0,i=s.dependOnParams.length;i>o;++o)p=s.dependOnParams[o],f+='||(h.call(p,"'+u(p)+'")'+(l&&a(l,p)?'&&p["'+u(p)+'"]!=="'+u(l[p])+'"':"")+")";f+=")?("+this._buildBuildFnParts(t,s.parts)+'):"")'}return f},t.prototype._isDataMatched=function(t){var e,r=this._options.data;if("function"==typeof t)return Boolean(t(r));if(t&&"object"==typeof t)for(e in t)if(a(t,e)&&(!r||"object"!=typeof r||r[e]!==t[e]))return!1;return!0},t.prototype._getPatternParamsIntersection=function(t,e){var r,n,o,i=[];for(r=0,n=t.length;n>r;r++)o=t[r],a(e,o)&&i.push(o);return i},t.prototype._getParamsWeight=function(t,e,r){var n,a=t._paramsMap,o=t._requiredParams,i=t._optionalParams,s=0;if(r){if(n=this._getPatternParamsIntersection(o,e),o.length!==n.length)return s;n=this._getPatternParamsIntersection(i,e),s=n.length*v+o.length*x}else n=this._getPatternParamsIntersection(a,e),s=n.length*x;return s||(s=1),s},t.prototype.match=function(t,e){var r=null;if("string"!=typeof t||e&&!this._isDataMatched(e))return r;for(var n,a=this._subPatterns,o=0,i=0,s=a.length;s>i;i++){var u=a[i],p=this._matchsubPattern(u,t);if(p){var f=this._getParamsWeight(u,p);f>=o&&(o=f,n=u,r=p)}}return r},t.prototype._matchsubPattern=function(t,e){var r,n,o,u,p,f,l,h=null,c=this._options,_=c.postMatch,d=c.defaults;if(r=e.match(t._parseRegExp)){for(h={},n=1,o=r.length;o>n;++n)if("undefined"!=typeof r[n]&&""!==r[n])if(u=t._paramsMap[n-1],u===b)l=r[n];else if(u===g){if(e.charAt(e.length-2)===P)return null}else h[u]=r[n];if(l&&c.useQueryString!==!1){f=s.parse(l);for(u in f)if(a(f,u)&&!a(h,u))if(p=f[u],t._mainParamsMap[u]&&i(p)&&(p=p[0]),i(p))for(h[u]=[],n=0,o=p.length;o>n;++n)this._checkParamValue(u,p[n])&&h[u].push(p[n]);else this._checkParamValue(u,p)&&(h[u]=p)}for(u in d)a(d,u)&&!a(h,u)&&(h[u]=d[u])}return h&&"function"==typeof _&&(h=_(h),h&&"object"==typeof h||(h=null)),h},t.prototype.build=function(t,e){var r,n,a=this._subPatterns,o=0;if(t||(t={}),a.length>1)for(var i=0,s=a.length;s>i;i++){var u=a[i],p=this._buildsubPatternParams(u,t,e);if(p){var f=this._getParamsWeight(u,t,e);f>o&&(o=f,n=u,r=p)}}else n=a[0],r=this._buildsubPatternParams(n,t,e);return r?this._buildsubPattern(n,r):null},t.prototype._buildsubPattern=function(t,e){return t._buildFn(e)},t.prototype._buildsubPatternParams=function(t,e,r){var n,o,i,u,p,f=this._options,l={},h=f.useQueryString!==!1,c={},_=f.preBuild;"function"==typeof _&&(e=_(e));for(o in e)if(a(e,o)&&null!==e[o]&&"undefined"!=typeof e[o]&&(t._mainParamsMap[o]||h)){if(i=e[o],r&&!this._checkParamValue(o,i))return null;(t._mainParamsMap[o]?l:c)[o]=i}if(r)for(u=0,p=t._requiredParams.length;p>u;++u)if(!a(l,t._requiredParams[u]))return null;return h&&(n=s.stringify(c),n&&(l[b]=n)),l},t.prototype.getData=function(){return this._options.data},t.prototype.getName=function(){return this._options.name},r.exports=t,r.exports},"./router":function(){function t(){return this instanceof t?(this._routes=[],this._routesByName={},void 0):new t}var r={},n=e("./route");return t.prototype.addRoute=function(t){var e,r;return e=new n(t),this._routes.push(e),r=e.getName(),r&&(this._routesByName[r]=e),e},t.prototype.find=function(){var t,e,r,n=[],a=this._routes;for(e=0,r=a.length;r>e;++e)t=a[e].match.apply(a[e],arguments),null!==t&&n.push([a[e],t]);return n},t.prototype.findFirst=function(){var t,e,r,n=this._routes;for(e=0,r=n.length;r>e;++e)if(t=n[e].match.apply(n[e],arguments),null!==t)return[n[e],t];return null},t.prototype.getRouteByName=function(t){return this._routesByName[t]||null},t.Route=n,r.exports=t,r.exports}}[t]()}var r=e("./router"),n=!0;"object"==typeof exports&&"string"!=typeof exports.nodeName&&(module.exports=r,n=!1),t.modules&&modules.define&&modules.require&&(modules.define("susanin",function(t){t(r)}),n=!1),"function"==typeof t.define&&define.amd&&(define(function(){return r}),n=!1),n&&(t.Susanin=r)}(this);